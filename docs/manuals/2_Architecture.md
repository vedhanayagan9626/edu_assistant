# EduAssistant: System Architecture & Data Flow

Understanding the internal mechanics of EduAssistant's RAG and departmental isolation.

---

## üèóÔ∏è 1. Orchestration Architecture
EduAssistant follows a modular architecture where the **API Layer** acts as the orchestrator between the **Client**, the **Knowledge Base**, and the **AI Engine**.

### High-Level Component Map
- **Client (React)**: Handles UI interactions and local session management.
- **Gateway (Flask)**: Enforces authentication, role checks, and routes requests.
- **Storage Layer**: Relational (PostgreSQL) + Vectorized (ChromaDB).
- **AI Engine (Gemini)**: Performs reasoning based on the provided context.

## üîÑ 2. The RAG Lifecycle
The process from document upload to AI answering follows a strict, verification-heavy pipeline.

1. **Ingestion**: A staff member uploads a PDF.
2. **Deconstruction**: The LangChain `RecursiveCharacterTextSplitter` breaks the text into overlapping chunks, preserving context.
3. **Vectorization**: The `SentenceTransformer` converts text into numerical vectors.
4. **Indexing**: Chunks are stored in a dedicated ChromaDB collection, unique to that **Subject ID**.
5. **Contextual Retrieval**: During a chat, the user's query is vectorized, and a similarity search is performed against the subject's collection.
6. **Prompt Augmentation**: The top K chunks (context) are injected into a system prompt for Gemini.
7. **Synthesis**: Gemini generates a response using *only* the provided context.

## üõ°Ô∏è 3. Data Isolation (Departmental)
Security is built into the architecture via two-fold isolation:

- **Relational Level**: Foreign key constraints link Users, Subjects, and Departments. Queries are strictly filtered by `department_id` at the database level.
- **Vector Level**: Every subject has its own distinct ChromaDB collection. It is physically impossible for a student in "Computer Science" to retrieve context from a "Business" subject collection.

## üìà 4. Scaling Capabilities
The architecture is designed for growth:
- **Stateless API**: Can be horizontally scaled using load balancers.
- **Modular Storage**: ChromaDB and PostgreSQL can be moved to dedicated high-performance servers if institutional load increases.

---
*Generated by EduAssistant Documentation Engine*
